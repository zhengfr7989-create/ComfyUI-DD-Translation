<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ComfyUI ç¿»è¯‘ JSON ç”Ÿæˆå™¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            margin: 0;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 20%, transparent 50%);
            animation: float 6s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translate(-50%, -50%) rotate(0deg); }
            50% { transform: translate(-50%, -50%) rotate(180deg); }
        }

        .header h1 {
            font-size: 2.8em;
            margin-bottom: 15px;
            font-weight: 700;
            text-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: relative;
            z-index: 1;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.95;
            position: relative;
            z-index: 1;
        }

        .main-content {
            padding: 50px;
        }

        .type-selector {
            margin-bottom: 50px;
        }

        .type-selector h2 {
            color: #2d3748;
            margin-bottom: 25px;
            font-size: 1.8em;
            font-weight: 600;
            text-align: center;
        }

        .type-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            max-width: 800px;
            margin: 0 auto;
        }

        .type-btn {
            padding: 25px 35px;
            border: 3px solid transparent;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            font-size: 1.2em;
            font-weight: 600;
            text-align: center;
            position: relative;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }

        .type-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            transition: left 0.5s;
        }

        .type-btn:hover::before {
            left: 100%;
        }

        .type-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.15);
        }

        .type-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }

        .config-section {
            display: none;
            background: white;
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border: 1px solid rgba(0,0,0,0.05);
        }

        .config-section.active {
            display: block;
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .node-name-input {
            margin-bottom: 30px;
        }

        .node-name-input label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #333;
        }

        .node-name-input input {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1.1em;
            transition: border-color 0.3s ease;
        }        .node-name-input input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .node-title-input {
            margin-bottom: 30px;
        }

        .node-title-input label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #333;
        }

        .node-title-input input {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1.1em;
            transition: border-color 0.3s ease;
        }

        .node-title-input input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .node-description-input {
            margin-bottom: 30px;
        }

        .node-description-input label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #333;
        }

        .node-description-input input {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1.1em;
            transition: border-color 0.3s ease;
        }

        .node-description-input input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }        .nodes-management {
            margin-bottom: 40px;
        }

        .node-tabs {
            display: flex;
            gap: 12px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            align-items: center;
        }

        .node-tab {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            border: 2px solid #e2e8f0;
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 1em;
            font-weight: 500;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
            position: relative;
            overflow: hidden;
            gap: 8px;
        }

        .node-tab::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(102, 126, 234, 0.1), transparent);
            transition: left 0.5s;
        }

        .node-tab:hover::before {
            left: 100%;
        }

        .node-tab:hover {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.15);
        }

        .node-tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
            box-shadow: 0 6px 16px rgba(102, 126, 234, 0.3);
        }

        .node-tab.active .tab-close {
            color: rgba(255,255,255,0.8);
        }

        .node-tab.active .tab-close:hover {
            background: rgba(255,255,255,0.2);
            color: white;
        }

        .tab-close {
            background: none;
            border: none;
            color: #64748b;
            margin-left: auto;
            font-size: 16px;
            cursor: pointer;
            padding: 4px;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            flex-shrink: 0;
        }

        .tab-close:hover {
            background: rgba(239, 68, 68, 0.1);
            color: #ef4444;
        }

        /* ä¸ºç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆæ— åˆ é™¤æŒ‰é’®ï¼‰ä¼˜åŒ–æ ·å¼ */
        .node-tab[data-node="0"] {
            padding: 12px 24px;
        }

        .node-tab[data-node="0"] span {
            margin: 0;
        }

        .btn {
            padding: 12px 18px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 500;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .btn-add {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3em;
            border-radius: 50%;
        }

        .btn-remove {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            font-size: 1.1em;
        }

        .btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }

        .btn-add:hover {
            background: linear-gradient(135deg, #059669 0%, #047857 100%);
        }

        .btn-remove:hover {
            background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
        }

        .add-section {
            text-align: center;
            margin-top: 20px;
        }

        .empty-state {
            text-align: center;
            color: #6b7280;
            font-style: italic;
            padding: 30px;
            background: rgba(255,255,255,0.5);
            border-radius: 10px;
            border: 2px dashed #d1d5db;
            margin: 15px 0;
        }

        .generate-section {
            text-align: center;
            margin-top: 50px;
            padding: 50px 40px;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            border-radius: 24px;
            border: 1px solid rgba(102, 126, 234, 0.1);
            box-shadow: 0 10px 40px rgba(0,0,0,0.05);
            position: relative;
            overflow: hidden;
        }

        .generate-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #764ba2, #10b981);
            opacity: 0.8;
        }

        .filename-input {
            margin-bottom: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
            background: white;
            padding: 25px 35px;
            border-radius: 18px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            border: 2px solid #f1f5f9;
            transition: all 0.3s ease;
            max-width: 600px;
            margin: 0 auto 35px auto;
        }

        .filename-input:hover {
            border-color: #e0e7ff;
            box-shadow: 0 8px 30px rgba(102, 126, 234, 0.1);
        }

        .filename-input label {
            font-weight: 700;
            color: #1e293b;
            font-size: 1.2em;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .filename-input input {
            flex: 1;
            min-width: 200px;
            padding: 18px 22px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 1.1em;
            font-weight: 500;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            background: linear-gradient(135deg, #fafbfc 0%, #f8fafc 100%);
            text-align: center;
        }

        .filename-input input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
            background: white;
            transform: scale(1.02);
        }

        .filename-input span {
            font-weight: 600;
            color: #64748b;
            font-size: 1.1em;
            white-space: nowrap;
        }

        @media (max-width: 768px) {
            .filename-input {
                flex-direction: column;
                text-align: center;
                padding: 20px 25px;
            }
            
            .filename-input input {
                min-width: auto;
                width: 100%;
                text-align: center;
            }
        }

        .node-basic-info {
            background: linear-gradient(135deg, #f0f8ff 0%, #e6f3ff 100%);
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid rgba(79, 172, 254, 0.2);
            box-shadow: 0 4px 15px rgba(79, 172, 254, 0.1);
        }        .node-name-input, .node-description-input, .node-title-input {
            margin-bottom: 25px;
        }

        .node-name-input label, .node-description-input label, .node-title-input label {
            display: block;
            margin-bottom: 12px;
            font-weight: 600;
            color: #1a202c;
            font-size: 1.1em;
        }

        .node-name-input input, .node-description-input input, .node-title-input input {
            width: 100%;
            padding: 18px 20px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 1.1em;
            transition: all 0.3s ease;
            background: white;
        }

        .node-name-input input:focus, .node-description-input input:focus, .node-title-input input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
        }.node-sections {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        @media (min-width: 1400px) {
            .node-sections {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 30px;
            }
            
            .key-value-section:last-child {
                grid-column: 1 / -1;
            }
        }

        .key-value-section {
            background: white;
            border-radius: 20px;
            padding: 35px;
            margin-bottom: 0;
            min-height: auto;
            border: 2px solid #f1f5f9;
            box-shadow: 0 4px 20px rgba(0,0,0,0.03);
            transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
            position: relative;
            overflow: hidden;
        }

        .key-value-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transform: scaleX(0);
            transform-origin: left;
            transition: transform 0.3s ease;
        }

        .key-value-section:hover::before {
            transform: scaleX(1);
        }

        .key-value-section:hover {
            box-shadow: 0 12px 40px rgba(102, 126, 234, 0.15);
            transform: translateY(-4px);
            border-color: #e0e7ff;
        }

        .section-title {
            color: #1e293b;
            margin-bottom: 30px;
            font-size: 1.3em;
            font-weight: 700;
            padding-left: 0;
            border-left: none;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .section-title::before {
            content: '';
            width: 6px;
            height: 6px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 50%;
            flex-shrink: 0;
        }

        .section-title::after {
            display: none;
        }

        .key-value-pair {
            display: grid;
            grid-template-columns: 1fr 1fr auto;
            gap: 16px;
            margin-bottom: 16px;
            align-items: center;
            padding: 0;
            background: transparent;
            border-radius: 0;
            box-shadow: none;
            transition: none;
        }

        .key-value-pair:hover {
            box-shadow: none;
            transform: none;
        }

        .key-value-pair input {
            flex: none;
            min-width: 0;
            padding: 16px 20px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 1em;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            background: #fafbfc;
            font-weight: 500;
        }

        .key-value-pair input:first-child {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            border-color: #cbd5e1;
        }

        .key-value-pair input:nth-child(2) {
            background: linear-gradient(135deg, #fefce8 0%, #fef3c7 100%);
            border-color: #d4d4aa;
        }

        .key-value-pair input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
            background: white;
            transform: translateY(-1px);
        }

        .key-value-pair input::placeholder {
            color: #94a3b8;
            font-weight: 400;
        }

        .btn-remove {
            background: #f1f5f9;
            color: #64748b;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
            font-size: 16px;
            border: 2px solid #e2e8f0;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .btn-remove:hover {
            background: #fee2e2;
            color: #dc2626;
            border-color: #fecaca;
            transform: scale(1.1);
        }

        .btn-add {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            border-radius: 16px;
            border: none;
            box-shadow: 0 4px 16px rgba(16, 185, 129, 0.25);
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .btn-add:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 8px 24px rgba(16, 185, 129, 0.35);
        }

        .btn-add:active {
            transform: translateY(0) scale(0.95);
        }

        .empty-state {
            text-align: center;
            color: #666;
            font-style: italic;
            padding: 20px;
        }

        .filename-input {
            margin-bottom: 20px;
        }

        .filename-input input {
            width: 300px;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 6px;
            margin-left: 10px;
        }

        .preview-content {
            background: #1a202c;
            color: #e2e8f0;
            border-radius: 12px;
            padding: 25px;
            font-family: 'JetBrains Mono', 'Fira Code', 'Courier New', monospace;
            white-space: pre-wrap;
            max-height: 500px;
            overflow-y: auto;
            line-height: 1.6;
            border: 1px solid #374151;
        }

        /* é¢„è§ˆåŒºåŸŸæ ·å¼ */
        .preview-section {
            margin-top: 40px;
            display: none;
            background: white;
            border-radius: 20px;
            padding: 35px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.1);
            border: 2px solid #f1f5f9;
            animation: slideIn 0.5s ease-out;
        }

        .preview-section.show {
            display: block;
        }

        .preview-title {
            color: #1e293b;
            margin-bottom: 25px;
            font-size: 1.4em;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .preview-title::before {
            content: '';
            width: 8px;
            height: 8px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 50%;
            flex-shrink: 0;
        }

        /* === æŒ‰é’®å±‚çº§è®¾è®¡ç³»ç»Ÿ === */
        
        /* ä¸»è¦æ“ä½œæŒ‰é’® - æœ€é«˜ä¼˜å…ˆçº§ */
        .btn-generate {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 18px 40px;
            font-size: 1.2em;
            font-weight: 700;
            border-radius: 16px;
            border: none;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
            transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
            position: relative;
            overflow: hidden;
            text-transform: none;
            letter-spacing: 0.5px;
            margin: 0 12px 15px 0;
            min-width: 180px;
        }

        .btn-generate::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.6s ease;
        }

        .btn-generate:hover::before {
            left: 100%;
        }

        .btn-generate:hover {
            transform: translateY(-4px) scale(1.02);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.4);
            background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%);
        }

        .btn-generate:active {
            transform: translateY(-1px) scale(0.98);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        /* æ¬¡è¦ç§¯ææ“ä½œæŒ‰é’® */
        .btn-contribute {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 16px 32px;
            font-size: 1.1em;
            font-weight: 600;
            border-radius: 14px;
            border: none;
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.25);
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            margin: 0 12px 15px 0;
            min-width: 160px;
            position: relative;
            overflow: hidden;
        }

        .btn-contribute::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s ease;
        }

        .btn-contribute:hover::before {
            left: 100%;
        }

        .btn-contribute:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 12px 30px rgba(16, 185, 129, 0.35);
            background: linear-gradient(135deg, #059669 0%, #047857 100%);
        }

        .btn-contribute:active {
            transform: translateY(-1px) scale(0.98);
        }

        /* å±é™©æ“ä½œæŒ‰é’® */
        .btn-clear {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            color: #64748b;
            padding: 14px 28px;
            font-size: 1em;
            font-weight: 500;
            border-radius: 12px;
            border: 2px solid #e2e8f0;
            box-shadow: 0 3px 10px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            margin: 0 12px 15px 0;
            min-width: 140px;
            cursor: pointer;
        }

        .btn-clear:hover {
            background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
            color: #dc2626;
            border-color: #fca5a5;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(220, 38, 38, 0.15);
        }

        .btn-clear:active {
            transform: translateY(0) scale(0.95);
        }

        /* æŒ‰é’®å®¹å™¨å¸ƒå±€ä¼˜åŒ– */
        .action-buttons {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            gap: 0;
            margin-top: 35px;
            padding-top: 25px;
            border-top: 2px solid #f1f5f9;
        }

        /* å“åº”å¼é€‚é… */
        @media (max-width: 768px) {
            .action-buttons {
                flex-direction: column;
                align-items: stretch;
                gap: 15px;
            }
            
            .btn-generate, .btn-contribute, .btn-clear {
                margin: 0;
                width: 100%;
                min-width: auto;
                justify-content: center;
                display: flex;
                align-items: center;
            }
            
            .btn-generate {
                padding: 20px 32px;
                font-size: 1.3em;
            }
            
            .btn-contribute {
                padding: 18px 28px;
                font-size: 1.15em;
            }
            
            .btn-clear {
                padding: 16px 24px;
                font-size: 1.05em;
            }
        }

        /* æŒ‰é’®åŠ è½½çŠ¶æ€ */
        .btn-loading {
            pointer-events: none;
            position: relative;
            color: transparent !important;
        }

        .btn-loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 20px;
            height: 20px;
            margin: -10px 0 0 -10px;
            border: 2px solid rgba(255,255,255,0.3);
            border-top: 2px solid rgba(255,255,255,0.8);
            border-radius: 50%;
            animation: btnSpin 0.8s linear infinite;
        }

        @keyframes btnSpin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* ç¦ç”¨çŠ¶æ€ */
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: none !important;
        }

        .btn:disabled:hover {
            transform: none !important;
            box-shadow: none !important;
        }

        .contribute-info {
            background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
            border: 2px solid #10b981;
            border-radius: 16px;
            padding: 35px;
            margin-top: 30px;
            display: none;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.1);
            text-align: center;
        }

        .contribute-info.show {
            display: block;
            animation: slideIn 0.5s ease-out;
        }

        .contribute-info h4 {
            color: #064e3b;
            margin-bottom: 20px;
            font-size: 1.4em;
            font-weight: 700;
        }

        .contribute-info p {
            color: #065f46;
            margin-bottom: 30px;
            line-height: 1.6;
            font-size: 1.1em;
        }

        .contribute-actions {
            display: flex;
            flex-direction: column;
            gap: 20px;
            max-width: 400px;
            margin: 0 auto;
        }

        .contribute-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 18px 32px;
            border-radius: 14px;
            font-size: 1.1em;
            font-weight: 600;
            text-decoration: none;
            border: none;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            position: relative;
            overflow: hidden;
            gap: 10px;
        }

        .contribute-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s ease;
        }

        .contribute-btn:hover::before {
            left: 100%;
        }

        .contribute-btn-primary {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.25);
        }

        .contribute-btn-primary:hover {
            background: linear-gradient(135deg, #059669 0%, #047857 100%);
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 12px 30px rgba(16, 185, 129, 0.35);
            color: white;
        }

        .contribute-btn-secondary {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            color: #374151;
            border: 2px solid #10b981;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }

        .contribute-btn-secondary:hover {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.3);
        }

        @media (min-width: 600px) {
            .contribute-actions {
                flex-direction: row;
                max-width: 500px;
            }
        }

        /* å¯¼å…¥åŠŸèƒ½åŒºåŸŸæ ·å¼ */
        .import-section {
            margin-bottom: 50px;
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border-radius: 20px;
            padding: 40px;
            border: 2px solid rgba(14, 165, 233, 0.2);
            box-shadow: 0 10px 30px rgba(14, 165, 233, 0.1);
            position: relative;
            overflow: hidden;
        }

        .import-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #0ea5e9, #3b82f6, #6366f1);
            opacity: 0.8;
        }

        .import-section h2 {
            color: #1e40af;
            margin-bottom: 25px;
            font-size: 1.8em;
            font-weight: 700;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }

        .import-area {
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            border: 1px solid rgba(14, 165, 233, 0.15);
        }

        .import-description {
            margin-bottom: 25px;
            padding: 20px;
            background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
            border-radius: 12px;
            border-left: 4px solid #3b82f6;
        }

        .import-description p {
            margin: 0 0 8px 0;
            color: #1e40af;
            line-height: 1.6;
        }

        .import-description p:last-child {
            margin-bottom: 0;
            color: #374151;
        }

        .import-controls {
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .btn-import {
            background: linear-gradient(135deg, #0ea5e9 0%, #3b82f6 100%);
            color: white;
            padding: 14px 28px;
            font-size: 1em;
            font-weight: 600;
            border-radius: 12px;
            border: none;
            box-shadow: 0 4px 15px rgba(14, 165, 233, 0.25);
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .btn-import::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s ease;
        }

        .btn-import:hover::before {
            left: 100%;
        }

        .btn-import:hover {
            background: linear-gradient(135deg, #3b82f6 0%, #6366f1 100%);
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 8px 25px rgba(14, 165, 233, 0.35);
        }

        .btn-import-process {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 14px 28px;
            font-size: 1em;
            font-weight: 600;
            border-radius: 12px;
            border: none;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.25);
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .btn-import-process:disabled {
            background: linear-gradient(135deg, #e5e7eb 0%, #d1d5db 100%);
            color: #9ca3af;
            cursor: not-allowed;
            box-shadow: none;
            transform: none !important;
        }

        .btn-import-process:not(:disabled)::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s ease;
        }

        .btn-import-process:not(:disabled):hover::before {
            left: 100%;
        }

        .btn-import-process:not(:disabled):hover {
            background: linear-gradient(135deg, #059669 0%, #047857 100%);
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.35);
        }

        .file-info {
            color: #64748b;
            font-size: 0.95em;
            font-weight: 500;
            padding: 8px 16px;
            background: #f8fafc;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 200px;
        }

        .file-info.selected {
            color: #059669;
            background: #ecfdf5;
            border-color: #a7f3d0;
        }

        .import-preview {
            background: #1a202c;
            color: #e2e8f0;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            border: 1px solid #374151;
        }

        .import-preview h4 {
            color: #3b82f6;
            margin-bottom: 15px;
            font-size: 1.1em;
            font-weight: 600;
        }

        .import-preview-content {
            font-family: 'JetBrains Mono', 'Fira Code', 'Courier New', monospace;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
            line-height: 1.5;
            font-size: 0.9em;
        }

        @media (max-width: 768px) {
            .import-controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .btn-import, .btn-import-process {
                width: 100%;
                justify-content: center;
            }
            
            .file-info {
                max-width: none;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¨ ComfyUI ç¿»è¯‘ç”Ÿæˆå™¨</h1>
            <p>è½»æ¾åˆ›å»º ComfyUI èŠ‚ç‚¹ã€åˆ†ç±»å’Œè®¾ç½®çš„ä¸­æ–‡ç¿»è¯‘æ–‡ä»¶</p>
        </div>
        
        <div class="main-content">
            <!-- ç±»å‹é€‰æ‹© -->
            <div class="type-selector">
                <h2>ğŸ“‹ é€‰æ‹©ç¿»è¯‘ç±»å‹</h2>
                <div class="type-buttons">
                    <button class="type-btn" data-type="categories">ğŸ“ åˆ†ç±»ç¿»è¯‘</button>
                    <button class="type-btn" data-type="nodes">ğŸ”§ èŠ‚ç‚¹ç¿»è¯‘</button>
                    <button class="type-btn" data-type="menus">âš™ï¸ è®¾ç½®èœå•</button>
                </div>
            </div>

            <!-- JSONæ–‡ä»¶å¯¼å…¥åŠŸèƒ½åŒºåŸŸ -->
            <div class="import-section">
                <h2>ğŸ“¥ å¯¼å…¥ç°æœ‰ç¿»è¯‘æ–‡ä»¶</h2>
                <div class="import-area">
                    <div class="import-description">
                        <p>ğŸ’¡ <strong>å¿«é€Ÿæ›´æ–°ç°æœ‰ç¿»è¯‘ï¼š</strong></p>
                        <p>é€‰æ‹©å·²æœ‰çš„ç¿»è¯‘JSONæ–‡ä»¶è¿›è¡Œå¯¼å…¥ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šæ·»åŠ æ–°çš„èŠ‚ç‚¹æˆ–ä¿®æ”¹ç°æœ‰ç¿»è¯‘ã€‚</p>
                    </div>
                    <div class="import-controls">
                        <input type="file" id="json-file-input" accept=".json" style="display: none;">
                        <button class="btn btn-import" onclick="triggerFileInput()">
                            ğŸ“ é€‰æ‹©JSONæ–‡ä»¶
                        </button>
                        <span class="file-info" id="file-info">æœªé€‰æ‹©æ–‡ä»¶</span>
                        <button class="btn btn-import-process" onclick="processImportedFile()" disabled>
                            ğŸš€ å¯¼å…¥å¹¶ç¼–è¾‘
                        </button>
                    </div>
                    <div class="import-preview" id="import-preview" style="display: none;">
                        <h4>ğŸ“„ æ–‡ä»¶é¢„è§ˆï¼š</h4>
                        <div class="import-preview-content" id="import-preview-content"></div>
                    </div>
                </div>
            </div>

            <!-- åˆ†ç±»ç¿»è¯‘é…ç½® -->
            <div class="config-section" id="categories-config">
                <div class="section-title">ğŸ“ åˆ†ç±»ç¿»è¯‘é…ç½®</div>
                <div class="key-value-section">
                    <div id="categories-pairs">
                        <div class="empty-state">ç‚¹å‡»ä¸‹æ–¹ + æŒ‰é’®æ·»åŠ åˆ†ç±»ç¿»è¯‘é¡¹</div>
                    </div>
                    <div class="add-section">
                        <button class="btn btn-add" onclick="addCategoryPair()">+</button>
                    </div>
                </div>
            </div>            <!-- èŠ‚ç‚¹ç¿»è¯‘é…ç½® -->
            <div class="config-section" id="nodes-config">
                <div class="nodes-management">
                    <div class="section-title">ğŸ“¦ å¤šèŠ‚ç‚¹ç®¡ç†</div>                    <div class="node-tabs" id="node-tabs">
                        <button class="node-tab active" data-node="0" onclick="switchToNode(0)">
                            <span>èŠ‚ç‚¹ 1</span>
                        </button>
                        <button class="btn btn-add-node" onclick="addNewNode()">+ æ·»åŠ èŠ‚ç‚¹</button>
                    </div>
                </div>

                <!-- èŠ‚ç‚¹å®¹å™¨ -->
                <div id="nodes-container">
                    <!-- ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ -->
                    <div class="single-node-config" id="node-config-0" style="display: block;">
                        <div class="node-basic-info">
                            <div class="node-name-input">
                                <label for="node-name-0">ğŸ¯ èŠ‚ç‚¹ç±»å (Class Name):</label>
                                <input type="text" id="node-name-0" placeholder="ä¾‹å¦‚: KSampler" onchange="updateNodeTab(0)">
                            </div>
                            
                            <div class="node-title-input">
                                <label for="node-title-0">ğŸ·ï¸ ç¿»è¯‘åæ ‡é¢˜ (å¿…å¡«):</label>
                                <input type="text" id="node-title-0" placeholder="ä¾‹å¦‚: Ké‡‡æ ·å™¨" required>
                            </div>
                            
                            <div class="node-description-input">
                                <label for="node-desc-0">ğŸ“ èŠ‚ç‚¹åŠŸèƒ½æè¿° (å¯é€‰):</label>
                                <input type="text" id="node-desc-0" placeholder="ä¾‹å¦‚: ä½¿ç”¨ä¸åŒçš„é‡‡æ ·å™¨å’Œè°ƒåº¦å™¨è¿›è¡Œå›¾åƒç”Ÿæˆ">
                            </div>
                        </div>

                        <div class="node-sections">
                            <!-- è¾“å…¥é¡¹ -->
                            <div class="key-value-section">
                                <div class="section-title">ğŸ“¥ è¾“å…¥ (Inputs)</div>
                                <div id="inputs-pairs-0">
                                    <div class="empty-state">ç‚¹å‡»ä¸‹æ–¹ + æŒ‰é’®æ·»åŠ è¾“å…¥é¡¹</div>
                                </div>
                                <div class="add-section">
                                    <button class="btn btn-add" onclick="addInputPair(0)">+</button>
                                </div>
                            </div>

                            <!-- æ§ä»¶é¡¹ -->
                            <div class="key-value-section">
                                <div class="section-title">ğŸ›ï¸ æ§ä»¶ (Widgets)</div>
                                <div id="widgets-pairs-0">
                                    <div class="empty-state">ç‚¹å‡»ä¸‹æ–¹ + æŒ‰é’®æ·»åŠ æ§ä»¶é¡¹</div>
                                </div>
                                <div class="add-section">
                                    <button class="btn btn-add" onclick="addWidgetPair(0)">+</button>
                                </div>
                            </div>

                            <!-- è¾“å‡ºé¡¹ -->
                            <div class="key-value-section">
                                <div class="section-title">ğŸ“¤ è¾“å‡º (Outputs)</div>
                                <div id="outputs-pairs-0">
                                    <div class="empty-state">ç‚¹å‡»ä¸‹æ–¹ + æŒ‰é’®æ·»åŠ è¾“å‡ºé¡¹</div>
                                </div>
                                <div class="add-section">
                                    <button class="btn btn-add" onclick="addOutputPair(0)">+</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- è®¾ç½®èœå•é…ç½® -->
            <div class="config-section" id="menus-config">
                <div class="section-title">âš™ï¸ è®¾ç½®èœå•é…ç½®</div>
                <div class="key-value-section">
                    <div id="menus-pairs">
                        <div class="empty-state">ç‚¹å‡»ä¸‹æ–¹ + æŒ‰é’®æ·»åŠ èœå•ç¿»è¯‘é¡¹</div>
                    </div>
                    <div class="add-section">
                        <button class="btn btn-add" onclick="addMenuPair()">+</button>
                    </div>
                </div>
            </div>            <!-- ç”ŸæˆæŒ‰é’® -->
            <div class="generate-section">
                <div class="filename-input">
                    <label>ğŸ“ æ–‡ä»¶å: </label>
                    <input type="text" id="filename" placeholder="ä¾‹å¦‚: ComfyUI-Manager">
                    <span>.json</span>
                </div>
                
                <div class="action-buttons">
                    <button class="btn btn-generate" onclick="generateJSON()">
                        ğŸš€ ç”Ÿæˆ JSON
                    </button>
                    <button class="btn btn-contribute" onclick="contributeTranslation()">
                        ğŸ¤ è´¡çŒ®ç¿»è¯‘
                    </button>
                    <button class="btn btn-clear" onclick="clearAll()">
                        ğŸ—‘ï¸ æ¸…ç©ºæ‰€æœ‰
                    </button>
                </div>
            </div>            <!-- è´¡çŒ®é€‰é¡¹ -->
            <div class="contribute-info" id="contribute-info">
                <h4>ğŸ‰ æ„Ÿè°¢æ‚¨çš„è´¡çŒ®ï¼</h4>
                <p>é€‰æ‹©æ‚¨å¸Œæœ›çš„è´¡çŒ®æ–¹å¼ï¼š</p>
                
                <div class="contribute-actions">
                    <a href="https://github.com/Dontdrunk/ComfyUI-DD-Translation" target="_blank" 
                       class="contribute-btn contribute-btn-primary">
                        ğŸ”— è®¿é—® GitHub é¡¹ç›®
                    </a>
                    <button onclick="createGitHubIssue()" class="contribute-btn contribute-btn-secondary">
                        ğŸ“ åˆ›å»ºè´¡çŒ® Issue
                    </button>
                </div>
            </div>

            <!-- é¢„è§ˆåŒºåŸŸ -->
            <div class="preview-section" id="preview">
                <div class="preview-title">ğŸ“„ JSON é¢„è§ˆ</div>
                <div class="preview-content" id="preview-content"></div>
            </div>
        </div>
    </div>    <script>
        let currentType = '';
        let currentNodeIndex = 0;
        let nodeCount = 1;

        // ç±»å‹é€‰æ‹©
        document.querySelectorAll('.type-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                // ç§»é™¤æ‰€æœ‰æ´»åŠ¨çŠ¶æ€
                document.querySelectorAll('.type-btn').forEach(b => b.classList.remove('active'));
                document.querySelectorAll('.config-section').forEach(s => s.classList.remove('active'));
                
                // è®¾ç½®å½“å‰æ´»åŠ¨çŠ¶æ€
                btn.classList.add('active');
                currentType = btn.dataset.type;
                document.getElementById(currentType + '-config').classList.add('active');
                
                // éšè—é¢„è§ˆ
                document.getElementById('preview').classList.remove('show');

                // å¦‚æœæ˜¯èŠ‚ç‚¹ç±»å‹ï¼Œåˆå§‹åŒ–èŠ‚ç‚¹åŒºåŸŸ
                if (currentType === 'nodes') {
                    initializeNodeSections();
                }
            });
        });

        // åˆå§‹åŒ–èŠ‚ç‚¹åŒºåŸŸ
        function initializeNodeSections() {
            const sectionsContainer = document.getElementById('node-sections-0');
            if (!sectionsContainer.innerHTML.trim()) {
                sectionsContainer.innerHTML = `
                    <!-- è¾“å…¥é¡¹ -->
                    <div class="key-value-section">
                        <div class="section-title">ğŸ“¥ è¾“å…¥ (Inputs)</div>
                        <div id="inputs-pairs-0">
                            <div class="empty-state">ç‚¹å‡»ä¸‹æ–¹ + æŒ‰é’®æ·»åŠ è¾“å…¥é¡¹</div>
                        </div>
                        <div class="add-section">
                            <button class="btn btn-add" onclick="addInputPair(0)">+</button>
                        </div>
                    </div>

                    <!-- æ§ä»¶é¡¹ -->
                    <div class="key-value-section">
                        <div class="section-title">ğŸ›ï¸ æ§ä»¶ (Widgets)</div>
                        <div id="widgets-pairs-0">
                            <div class="empty-state">ç‚¹å‡»ä¸‹æ–¹ + æŒ‰é’®æ·»åŠ æ§ä»¶é¡¹</div>
                        </div>
                        <div class="add-section">
                            <button class="btn btn-add" onclick="addWidgetPair(0)">+</button>
                        </div>
                    </div>

                    <!-- è¾“å‡ºé¡¹ -->
                    <div class="key-value-section">
                        <div class="section-title">ğŸ“¤ è¾“å‡º (Outputs)</div>
                        <div id="outputs-pairs-0">
                            <div class="empty-state">ç‚¹å‡»ä¸‹æ–¹ + æŒ‰é’®æ·»åŠ è¾“å‡ºé¡¹</div>
                        </div>
                        <div class="add-section">
                            <button class="btn btn-add" onclick="addOutputPair(0)">+</button>
                        </div>
                    </div>
                `;
            }
        }        // æ·»åŠ é”®å€¼å¯¹çš„é€šç”¨å‡½æ•°
        function createKeyValuePair(containerId, onRemove) {
            const pair = document.createElement('div');
            pair.className = 'key-value-pair';
            pair.innerHTML = `
                <input type="text" placeholder="è‹±æ–‡åŸæ–‡">
                <input type="text" placeholder="ä¸­æ–‡ç¿»è¯‘">
                <button class="btn btn-remove" onclick="${onRemove}(this)">Ã—</button>
            `;
            return pair;
        }        // æ·»åŠ æ–°èŠ‚ç‚¹
        function addNewNode() {
            const nodeIndex = nodeCount;
            nodeCount++;

            // æ·»åŠ èŠ‚ç‚¹æ ‡ç­¾
            const tabsContainer = document.querySelector('.node-tabs');
            const addButton = tabsContainer.querySelector('.btn-add-node');
            
            const newTab = document.createElement('button');
            newTab.className = 'node-tab';
            newTab.setAttribute('data-node', nodeIndex);
            newTab.onclick = () => switchToNode(nodeIndex);
            newTab.innerHTML = `
                <span>èŠ‚ç‚¹ ${nodeIndex + 1}</span>
                <button class="tab-close" onclick="removeNode(${nodeIndex}, event)">Ã—</button>
            `;
            
            tabsContainer.insertBefore(newTab, addButton);

            // åˆ›å»ºæ–°çš„èŠ‚ç‚¹é…ç½®
            const nodesContainer = document.getElementById('nodes-container');
            const newNodeConfig = document.createElement('div');
            newNodeConfig.className = 'single-node-config';
            newNodeConfig.id = `node-config-${nodeIndex}`;
            newNodeConfig.innerHTML = `
                <div class="node-basic-info">
                    <div class="node-name-input">
                        <label for="node-name-${nodeIndex}">ğŸ¯ èŠ‚ç‚¹ç±»å (Class Name):</label>
                        <input type="text" id="node-name-${nodeIndex}" placeholder="ä¾‹å¦‚: KSampler" onchange="updateNodeTab(${nodeIndex})">
                    </div>
                    
                    <div class="node-title-input">
                        <label for="node-title-${nodeIndex}">ğŸ·ï¸ ç¿»è¯‘åæ ‡é¢˜ (å¿…å¡«):</label>
                        <input type="text" id="node-title-${nodeIndex}" placeholder="ä¾‹å¦‚: Ké‡‡æ ·å™¨" required>
                    </div>
                    
                    <div class="node-description-input">
                        <label for="node-desc-${nodeIndex}">ğŸ“ èŠ‚ç‚¹åŠŸèƒ½æè¿° (å¯é€‰):</label>
                        <input type="text" id="node-desc-${nodeIndex}" placeholder="ä¾‹å¦‚: ä½¿ç”¨ä¸åŒçš„é‡‡æ ·å™¨å’Œè°ƒåº¦å™¨è¿›è¡Œå›¾åƒç”Ÿæˆ">
                    </div>
                </div>

                <div class="node-sections">
                    <!-- è¾“å…¥é¡¹ -->
                    <div class="key-value-section">
                        <div class="section-title">ğŸ“¥ è¾“å…¥ (Inputs)</div>
                        <div id="inputs-pairs-${nodeIndex}">
                            <div class="empty-state">ç‚¹å‡»ä¸‹æ–¹ + æŒ‰é’®æ·»åŠ è¾“å…¥é¡¹</div>
                        </div>
                        <div class="add-section">
                            <button class="btn btn-add" onclick="addInputPair(${nodeIndex})">+</button>
                        </div>
                    </div>

                    <!-- æ§ä»¶é¡¹ -->
                    <div class="key-value-section">
                        <div class="section-title">ğŸ›ï¸ æ§ä»¶ (Widgets)</div>
                        <div id="widgets-pairs-${nodeIndex}">
                            <div class="empty-state">ç‚¹å‡»ä¸‹æ–¹ + æŒ‰é’®æ·»åŠ æ§ä»¶é¡¹</div>
                        </div>
                        <div class="add-section">
                            <button class="btn btn-add" onclick="addWidgetPair(${nodeIndex})">+</button>
                        </div>
                    </div>

                    <!-- è¾“å‡ºé¡¹ -->
                    <div class="key-value-section">
                        <div class="section-title">ğŸ“¤ è¾“å‡º (Outputs)</div>
                        <div id="outputs-pairs-${nodeIndex}">
                            <div class="empty-state">ç‚¹å‡»ä¸‹æ–¹ + æŒ‰é’®æ·»åŠ è¾“å‡ºé¡¹</div>
                        </div>
                        <div class="add-section">
                            <button class="btn btn-add" onclick="addOutputPair(${nodeIndex})">+</button>
                        </div>
                    </div>
                </div>
            `;
            
            nodesContainer.appendChild(newNodeConfig);

            // åˆ‡æ¢åˆ°æ–°èŠ‚ç‚¹
            switchToNode(nodeIndex);
        }        // åˆ é™¤èŠ‚ç‚¹
        function removeNode(nodeIndex, event) {
            event.stopPropagation(); // é˜»æ­¢äº‹ä»¶å†’æ³¡
            
            // ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆç´¢å¼•ä¸º0ï¼‰ä¸å…è®¸åˆ é™¤
            if (nodeIndex === 0) {
                alert('ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ä¸èƒ½åˆ é™¤ï¼');
                return;
            }
            
            // å¦‚æœåªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¸å…è®¸åˆ é™¤
            const allTabs = document.querySelectorAll('.node-tab[data-node]');
            if (allTabs.length <= 1) {
                alert('è‡³å°‘éœ€è¦ä¿ç•™ä¸€ä¸ªèŠ‚ç‚¹ï¼');
                return;
            }
            
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªèŠ‚ç‚¹å—ï¼Ÿ')) {
                // åˆ é™¤æ ‡ç­¾
                const tab = document.querySelector(`[data-node="${nodeIndex}"]`);
                if (tab) tab.remove();
                
                // åˆ é™¤é…ç½®
                const config = document.getElementById(`node-config-${nodeIndex}`);
                if (config) config.remove();
                
                // å¦‚æœåˆ é™¤çš„æ˜¯å½“å‰æ¿€æ´»çš„èŠ‚ç‚¹ï¼Œåˆ‡æ¢åˆ°ç¬¬ä¸€ä¸ªèŠ‚ç‚¹
                if (currentNodeIndex === nodeIndex) {
                    switchToNode(0); // æ€»æ˜¯åˆ‡æ¢åˆ°ç¬¬ä¸€ä¸ªèŠ‚ç‚¹
                }
            }
        }

        // åˆ‡æ¢èŠ‚ç‚¹
        function switchToNode(nodeIndex) {
            // æ›´æ–°æ ‡ç­¾çŠ¶æ€
            document.querySelectorAll('.node-tab[data-node]').forEach(tab => {
                tab.classList.remove('active');
                if (parseInt(tab.getAttribute('data-node')) === nodeIndex) {
                    tab.classList.add('active');
                }
            });

            // éšè—æ‰€æœ‰èŠ‚ç‚¹é…ç½®
            document.querySelectorAll('.single-node-config').forEach(config => {
                config.style.display = 'none';
            });

            // æ˜¾ç¤ºå½“å‰èŠ‚ç‚¹é…ç½®
            const currentConfig = document.getElementById(`node-config-${nodeIndex}`);
            if (currentConfig) {
                currentConfig.style.display = 'block';
            }

            currentNodeIndex = nodeIndex;
        }

        // æ›´æ–°èŠ‚ç‚¹æ ‡ç­¾æ˜¾ç¤º
        function updateNodeTab(nodeIndex) {
            const nodeName = document.getElementById(`node-name-${nodeIndex}`).value.trim();
            const tab = document.querySelector(`[data-node="${nodeIndex}"] span`);
            if (tab) {
                tab.textContent = nodeName || `èŠ‚ç‚¹ ${nodeIndex + 1}`;
            }
        }

        // åˆ†ç±»ç¿»è¯‘ç›¸å…³å‡½æ•°
        function addCategoryPair() {
            const container = document.getElementById('categories-pairs');
            if (container.querySelector('.empty-state')) {
                container.innerHTML = '';
            }
            const pair = createKeyValuePair('categories-pairs', 'removeCategoryPair');
            container.appendChild(pair);
        }

        function removeCategoryPair(btn) {
            const container = document.getElementById('categories-pairs');
            btn.parentElement.remove();
            if (container.children.length === 0) {
                container.innerHTML = '<div class="empty-state">ç‚¹å‡»ä¸‹æ–¹ + æŒ‰é’®æ·»åŠ åˆ†ç±»ç¿»è¯‘é¡¹</div>';
            }
        }        // èŠ‚ç‚¹è¾“å…¥ç›¸å…³å‡½æ•°
        function addInputPair(nodeIndex = 0) {
            const container = document.getElementById(`inputs-pairs-${nodeIndex}`);
            if (container.querySelector('.empty-state')) {
                container.innerHTML = '';
            }
            const pair = createKeyValuePair(`inputs-pairs-${nodeIndex}`, 'removeInputPair');
            container.appendChild(pair);
        }

        function removeInputPair(btn) {
            const container = btn.parentElement.parentElement;
            btn.parentElement.remove();
            if (container.children.length === 0) {
                container.innerHTML = '<div class="empty-state">ç‚¹å‡»ä¸‹æ–¹ + æŒ‰é’®æ·»åŠ è¾“å…¥é¡¹</div>';
            }
        }

        // èŠ‚ç‚¹æ§ä»¶ç›¸å…³å‡½æ•°
        function addWidgetPair(nodeIndex = 0) {
            const container = document.getElementById(`widgets-pairs-${nodeIndex}`);
            if (container.querySelector('.empty-state')) {
                container.innerHTML = '';
            }
            const pair = createKeyValuePair(`widgets-pairs-${nodeIndex}`, 'removeWidgetPair');
            container.appendChild(pair);
        }

        function removeWidgetPair(btn) {
            const container = btn.parentElement.parentElement;
            btn.parentElement.remove();
            if (container.children.length === 0) {
                container.innerHTML = '<div class="empty-state">ç‚¹å‡»ä¸‹æ–¹ + æŒ‰é’®æ·»åŠ æ§ä»¶é¡¹</div>';
            }
        }

        // èŠ‚ç‚¹è¾“å‡ºç›¸å…³å‡½æ•°
        function addOutputPair(nodeIndex = 0) {
            const container = document.getElementById(`outputs-pairs-${nodeIndex}`);
            if (container.querySelector('.empty-state')) {
                container.innerHTML = '';
            }
            const pair = createKeyValuePair(`outputs-pairs-${nodeIndex}`, 'removeOutputPair');
            container.appendChild(pair);
        }

        function removeOutputPair(btn) {
            const container = btn.parentElement.parentElement;
            btn.parentElement.remove();
            if (container.children.length === 0) {
                container.innerHTML = '<div class="empty-state">ç‚¹å‡»ä¸‹æ–¹ + æŒ‰é’®æ·»åŠ è¾“å‡ºé¡¹</div>';
            }
        }

        // èœå•ç¿»è¯‘ç›¸å…³å‡½æ•°
        function addMenuPair() {
            const container = document.getElementById('menus-pairs');
            if (container.querySelector('.empty-state')) {
                container.innerHTML = '';
            }
            const pair = createKeyValuePair('menus-pairs', 'removeMenuPair');
            container.appendChild(pair);
        }

        function removeMenuPair(btn) {
            const container = document.getElementById('menus-pairs');
            btn.parentElement.remove();
            if (container.children.length === 0) {
                container.innerHTML = '<div class="empty-state">ç‚¹å‡»ä¸‹æ–¹ + æŒ‰é’®æ·»åŠ èœå•ç¿»è¯‘é¡¹</div>';
            }
        }

        // è·å–é”®å€¼å¯¹æ•°æ®
        function getKeyValueData(containerId) {
            const container = document.getElementById(containerId);
            const pairs = container.querySelectorAll('.key-value-pair');
            const data = {};
            
            pairs.forEach(pair => {
                const inputs = pair.querySelectorAll('input');
                const key = inputs[0].value.trim();
                const value = inputs[1].value.trim();
                if (key && value) {
                    data[key] = value;
                }
            });
            
            return data;
        }        // ç”ŸæˆJSON
        function generateJSON() {
            if (!currentType) {
                alert('è¯·å…ˆé€‰æ‹©ç¿»è¯‘ç±»å‹ï¼');
                return;
            }

            let jsonData = {};

            if (currentType === 'categories' || currentType === 'menus') {
                const pairsId = currentType + '-pairs';
                jsonData = getKeyValueData(pairsId);
            } else if (currentType === 'nodes') {
                // è·å–æ‰€æœ‰å­˜åœ¨çš„èŠ‚ç‚¹
                const nodeConfigs = document.querySelectorAll('.single-node-config');
                
                nodeConfigs.forEach(config => {
                    const nodeIndex = config.id.split('-')[2]; // ä» node-config-X è·å– X
                    const nodeNameElement = document.getElementById(`node-name-${nodeIndex}`);
                    
                    if (nodeNameElement) {
                        const nodeName = nodeNameElement.value.trim();                        if (nodeName) {
                            const nodeData = {};
                            
                            // æ·»åŠ æ ‡é¢˜ï¼ˆå¿…å¡«ï¼‰
                            const nodeTitle = document.getElementById(`node-title-${nodeIndex}`).value.trim();
                            if (!nodeTitle) {
                                alert(`èŠ‚ç‚¹ "${nodeName}" çš„ç¿»è¯‘æ ‡é¢˜ä¸èƒ½ä¸ºç©ºï¼`);
                                return;
                            }
                            nodeData.title = nodeTitle;
                            
                            // æ·»åŠ æè¿°ï¼ˆå¦‚æœæœ‰ï¼‰
                            const nodeDesc = document.getElementById(`node-desc-${nodeIndex}`).value.trim();
                            if (nodeDesc) {
                                nodeData.description = nodeDesc;
                            }
                            
                            const inputs = getKeyValueData(`inputs-pairs-${nodeIndex}`);
                            const widgets = getKeyValueData(`widgets-pairs-${nodeIndex}`);
                            const outputs = getKeyValueData(`outputs-pairs-${nodeIndex}`);

                            if (Object.keys(inputs).length > 0) {
                                nodeData.inputs = inputs;
                            }
                            if (Object.keys(widgets).length > 0) {
                                nodeData.widgets = widgets;
                            }
                            if (Object.keys(outputs).length > 0) {
                                nodeData.outputs = outputs;
                            }

                            // åªæœ‰å½“èŠ‚ç‚¹æœ‰å®é™…å†…å®¹æ—¶æ‰æ·»åŠ 
                            if (Object.keys(nodeData).length > 0) {
                                jsonData[nodeName] = nodeData;
                            }
                        }
                    }
                });
            }

            if (Object.keys(jsonData).length === 0) {
                alert('è¯·æ·»åŠ è‡³å°‘ä¸€ä¸ªç¿»è¯‘é¡¹ï¼');
                return;
            }

            // æ˜¾ç¤ºé¢„è§ˆ
            const jsonString = JSON.stringify(jsonData, null, 4);
            const previewElement = document.getElementById('preview-content');
            const previewSection = document.getElementById('preview');
            
            console.log('JSONæ•°æ®:', jsonData); // è°ƒè¯•ä¿¡æ¯
            console.log('JSONå­—ç¬¦ä¸²:', jsonString); // è°ƒè¯•ä¿¡æ¯
            
            if (previewElement) {
                previewElement.textContent = jsonString;
                console.log('é¢„è§ˆå†…å®¹å·²è®¾ç½®'); // è°ƒè¯•ä¿¡æ¯
            } else {
                console.error('æ‰¾ä¸åˆ°é¢„è§ˆå…ƒç´ '); // è°ƒè¯•ä¿¡æ¯
            }
            
            if (previewSection) {
                previewSection.classList.add('show');
                // æ»šåŠ¨åˆ°é¢„è§ˆåŒºåŸŸ
                previewSection.scrollIntoView({ behavior: 'smooth' });
                console.log('é¢„è§ˆåŒºåŸŸå·²æ˜¾ç¤º'); // è°ƒè¯•ä¿¡æ¯
            } else {
                console.error('æ‰¾ä¸åˆ°é¢„è§ˆåŒºåŸŸ'); // è°ƒè¯•ä¿¡æ¯
            }

            // ä¸‹è½½æ–‡ä»¶
            downloadJSON(jsonData);
        }

        // ä¸‹è½½JSONæ–‡ä»¶
        function downloadJSON(data) {
            const filename = document.getElementById('filename').value.trim() || 'translation';
            const jsonString = JSON.stringify(data, null, 4);
            const blob = new Blob([jsonString], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = filename + '.json';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }        // æ¸…ç©ºæ‰€æœ‰
        function clearAll() {
            if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰å†…å®¹å—ï¼Ÿ')) {
                // æ¸…ç©ºæ‰€æœ‰è¾“å…¥
                document.querySelectorAll('input').forEach(input => input.value = '');
                
                // é‡ç½®å¯¼å…¥çŠ¶æ€
                resetImportState();
                
                // é‡ç½®åˆ†ç±»å’Œèœå•å®¹å™¨
                const simpleContainers = ['categories-pairs', 'menus-pairs'];
                simpleContainers.forEach(id => {
                    const container = document.getElementById(id);
                    if (container) {
                        let emptyText = 'ç‚¹å‡»ä¸‹æ–¹ + æŒ‰é’®æ·»åŠ ç¿»è¯‘é¡¹';
                        if (id.includes('categories')) emptyText = 'ç‚¹å‡»ä¸‹æ–¹ + æŒ‰é’®æ·»åŠ åˆ†ç±»ç¿»è¯‘é¡¹';
                        else if (id.includes('menus')) emptyText = 'ç‚¹å‡»ä¸‹æ–¹ + æŒ‰é’®æ·»åŠ èœå•ç¿»è¯‘é¡¹';
                        
                        container.innerHTML = `<div class="empty-state">${emptyText}</div>`;
                    }
                });
                
                // é‡ç½®èŠ‚ç‚¹ç›¸å…³
                if (currentType === 'nodes') {
                    // é‡ç½®ä¸ºå•ä¸ªèŠ‚ç‚¹
                    nodeCount = 1;
                    currentNodeIndex = 0;
                      // é‡ç½®èŠ‚ç‚¹æ ‡ç­¾
                    const tabsContainer = document.querySelector('.node-tabs');
                    if (tabsContainer) {
                        tabsContainer.innerHTML = `
                            <button class="node-tab active" data-node="0" onclick="switchToNode(0)">
                                <span>èŠ‚ç‚¹ 1</span>
                            </button>
                            <button class="btn btn-add-node" onclick="addNewNode()">+ æ·»åŠ èŠ‚ç‚¹</button>
                        `;
                    }
                    
                    // æ¸…ç†å¤šä½™çš„èŠ‚ç‚¹é…ç½®
                    const nodesContainer = document.getElementById('nodes-container');
                    if (nodesContainer) {
                        nodesContainer.innerHTML = `
                            <div class="single-node-config" id="node-config-0" style="display: block;">
                                <div class="node-basic-info">
                                    <div class="node-name-input">
                                        <label for="node-name-0">ğŸ¯ èŠ‚ç‚¹ç±»å (Class Name):</label>
                                        <input type="text" id="node-name-0" placeholder="ä¾‹å¦‚: KSampler" onchange="updateNodeTab(0)">
                                    </div>
                                    
                                    <div class="node-title-input">
                                        <label for="node-title-0">ğŸ·ï¸ ç¿»è¯‘åæ ‡é¢˜ (å¿…å¡«):</label>
                                        <input type="text" id="node-title-0" placeholder="ä¾‹å¦‚: Ké‡‡æ ·å™¨" required>
                                    </div>
                                    
                                    <div class="node-description-input">
                                        <label for="node-desc-0">ğŸ“ èŠ‚ç‚¹åŠŸèƒ½æè¿° (å¯é€‰):</label>
                                        <input type="text" id="node-desc-0" placeholder="ä¾‹å¦‚: ä½¿ç”¨ä¸åŒçš„é‡‡æ ·å™¨å’Œè°ƒåº¦å™¨è¿›è¡Œå›¾åƒç”Ÿæˆ">
                                    </div>
                                </div>

                                <div class="node-sections">
                                    <div class="key-value-section">
                                        <div class="section-title">ğŸ“¥ è¾“å…¥ (Inputs)</div>
                                        <div id="inputs-pairs-0">
                                            <div class="empty-state">ç‚¹å‡»ä¸‹æ–¹ + æŒ‰é’®æ·»åŠ è¾“å…¥é¡¹</div>
                                        </div>
                                        <div class="add-section">
                                            <button class="btn btn-add" onclick="addInputPair(0)">+</button>
                                        </div>
                                    </div>

                                    <div class="key-value-section">
                                        <div class="section-title">ğŸ›ï¸ æ§ä»¶ (Widgets)</div>
                                        <div id="widgets-pairs-0">
                                            <div class="empty-state">ç‚¹å‡»ä¸‹æ–¹ + æŒ‰é’®æ·»åŠ æ§ä»¶é¡¹</div>
                                        </div>
                                        <div class="add-section">
                                            <button class="btn btn-add" onclick="addWidgetPair(0)">+</button>
                                        </div>
                                    </div>

                                    <div class="key-value-section">
                                        <div class="section-title">ğŸ“¤ è¾“å‡º (Outputs)</div>
                                        <div id="outputs-pairs-0">
                                            <div class="empty-state">ç‚¹å‡»ä¸‹æ–¹ + æŒ‰é’®æ·»åŠ è¾“å‡ºé¡¹</div>
                                        </div>
                                        <div class="add-section">
                                            <button class="btn btn-add" onclick="addOutputPair(0)">+</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `;
                    }
                }
                
                // éšè—é¢„è§ˆå’Œè´¡çŒ®ä¿¡æ¯
                document.getElementById('preview').classList.remove('show');
                document.getElementById('contribute-info').classList.remove('show');
                
                // é‡ç½®ç±»å‹é€‰æ‹©
                document.querySelectorAll('.type-btn').forEach(btn => btn.classList.remove('active'));
                document.querySelectorAll('.config-section').forEach(section => section.classList.remove('active'));
                currentType = '';
            }
        }// è´¡çŒ®ç¿»è¯‘
        function contributeTranslation() {
            if (!currentType) {
                alert('è¯·å…ˆé€‰æ‹©ç¿»è¯‘ç±»å‹ï¼');
                return;
            }
            
            const contributeInfo = document.getElementById('contribute-info');
            if (contributeInfo.classList.contains('show')) {
                contributeInfo.classList.remove('show');
            } else {
                contributeInfo.classList.add('show');
                // æ»šåŠ¨åˆ°è´¡çŒ®ä¿¡æ¯åŒºåŸŸ
                contributeInfo.scrollIntoView({ behavior: 'smooth' });
            }
        }        // åˆ›å»ºGitHub Issue
        function createGitHubIssue() {
            if (!currentType) {
                alert('è¯·å…ˆé€‰æ‹©ç¿»è¯‘ç±»å‹å¹¶æ·»åŠ ç¿»è¯‘å†…å®¹ï¼');
                return;
            }

            let issueTitle = '';
            let issueBody = '';
            const filename = document.getElementById('filename').value.trim() || 'translation';
            
            // æ ¹æ®ç¿»è¯‘ç±»å‹ç”Ÿæˆä¸åŒçš„Issueæ ‡é¢˜å’Œå†…å®¹
            if (currentType === 'categories') {
                issueTitle = `[ç¿»è¯‘è´¡çŒ®] åˆ†ç±»ç¿»è¯‘ - ${filename}`;
                issueBody = `## ç¿»è¯‘ç±»å‹\nğŸ“ åˆ†ç±»ç¿»è¯‘ (Categories)\n\n## æ–‡ä»¶å\n${filename}.json\n\n## ç¿»è¯‘å†…å®¹æè¿°\nè¯·åœ¨æ­¤æè¿°æ‚¨ç¿»è¯‘çš„åˆ†ç±»å†…å®¹...\n\n## é™„ä»¶\nè¯·å°†ç”Ÿæˆçš„ JSON æ–‡ä»¶ä½œä¸ºé™„ä»¶ä¸Šä¼ åˆ°æ­¤ Issue\n\n---\n*é€šè¿‡ ComfyUI ç¿»è¯‘ç”Ÿæˆå™¨åˆ›å»º*`;
            } else if (currentType === 'nodes') {
                // è·å–ç¬¬ä¸€ä¸ªèŠ‚ç‚¹åç§°ä½œä¸ºç¤ºä¾‹
                const firstNodeName = document.getElementById('node-name-0').value.trim();
                issueTitle = `[ç¿»è¯‘è´¡çŒ®] èŠ‚ç‚¹ç¿»è¯‘ - ${firstNodeName || filename}`;
                issueBody = `## ç¿»è¯‘ç±»å‹\nğŸ”§ èŠ‚ç‚¹ç¿»è¯‘ (Nodes)\n\n## èŠ‚ç‚¹åç§°\n${firstNodeName || 'è¯·å¡«å†™èŠ‚ç‚¹ç±»å'}\n\n## æ–‡ä»¶å\n${filename}.json\n\n## ç¿»è¯‘å†…å®¹æè¿°\nè¯·åœ¨æ­¤æè¿°æ‚¨ç¿»è¯‘çš„èŠ‚ç‚¹åŠŸèƒ½å’Œç”¨é€”...\n\n## é™„ä»¶\nè¯·å°†ç”Ÿæˆçš„ JSON æ–‡ä»¶ä½œä¸ºé™„ä»¶ä¸Šä¼ åˆ°æ­¤ Issue\n\n---\n*é€šè¿‡ ComfyUI ç¿»è¯‘ç”Ÿæˆå™¨åˆ›å»º*`;
            } else if (currentType === 'menus') {
                issueTitle = `[ç¿»è¯‘è´¡çŒ®] è®¾ç½®èœå•ç¿»è¯‘ - ${filename}`;
                issueBody = `## ç¿»è¯‘ç±»å‹\nâš™ï¸ è®¾ç½®èœå•ç¿»è¯‘ (Menus)\n\n## æ–‡ä»¶å\n${filename}.json\n\n## ç¿»è¯‘å†…å®¹æè¿°\nè¯·åœ¨æ­¤æè¿°æ‚¨ç¿»è¯‘çš„èœå•æˆ–è®¾ç½®é¡¹...\n\n## é™„ä»¶\nè¯·å°†ç”Ÿæˆçš„ JSON æ–‡ä»¶ä½œä¸ºé™„ä»¶ä¸Šä¼ åˆ°æ­¤ Issue\n\n---\n*é€šè¿‡ ComfyUI ç¿»è¯‘ç”Ÿæˆå™¨åˆ›å»º*`;
            }

            // æ„å»ºGitHub Issue URL
            const repoUrl = 'https://github.com/Dontdrunk/ComfyUI-DD-Translation';
            const issueUrl = `${repoUrl}/issues/new?title=${encodeURIComponent(issueTitle)}&body=${encodeURIComponent(issueBody)}&labels=ç¿»è¯‘è´¡çŒ®`;
            
            // æ‰“å¼€GitHub Issueé¡µé¢
            window.open(issueUrl, '_blank');
        }

        // JSONæ–‡ä»¶å¯¼å…¥åŠŸèƒ½ç›¸å…³å˜é‡
        let importedJsonData = null;
        let importedFileName = '';

        // è§¦å‘æ–‡ä»¶é€‰æ‹©
        function triggerFileInput() {
            document.getElementById('json-file-input').click();
        }

        // ç›‘å¬æ–‡ä»¶é€‰æ‹©
        document.addEventListener('DOMContentLoaded', function() {
            const fileInput = document.getElementById('json-file-input');
            fileInput.addEventListener('change', function(event) {
                const file = event.target.files[0];
                if (file) {
                    handleFileSelection(file);
                }
            });
        });

        // å¤„ç†æ–‡ä»¶é€‰æ‹©
        function handleFileSelection(file) {
            if (file.type !== 'application/json' && !file.name.toLowerCase().endsWith('.json')) {
                alert('è¯·é€‰æ‹©æœ‰æ•ˆçš„JSONæ–‡ä»¶ï¼');
                return;
            }

            const fileInfo = document.getElementById('file-info');
            const importPreview = document.getElementById('import-preview');
            const importBtn = document.querySelector('.btn-import-process');

            // æ›´æ–°æ–‡ä»¶ä¿¡æ¯æ˜¾ç¤º
            fileInfo.textContent = file.name;
            fileInfo.classList.add('selected');
            importedFileName = file.name.replace('.json', '');

            // è¯»å–æ–‡ä»¶å†…å®¹
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const jsonContent = e.target.result;
                    importedJsonData = JSON.parse(jsonContent);
                    
                    // æ˜¾ç¤ºé¢„è§ˆ
                    const previewContent = document.getElementById('import-preview-content');
                    previewContent.textContent = JSON.stringify(importedJsonData, null, 2);
                    importPreview.style.display = 'block';
                    
                    // å¯ç”¨å¯¼å…¥æŒ‰é’®
                    importBtn.disabled = false;
                    
                    // è‡ªåŠ¨è®¾ç½®æ–‡ä»¶å
                    const filenameInput = document.getElementById('filename');
                    if (!filenameInput.value.trim()) {
                        filenameInput.value = importedFileName;
                    }
                    
                } catch (error) {
                    alert('JSONæ–‡ä»¶æ ¼å¼é”™è¯¯ï¼Œè¯·æ£€æŸ¥æ–‡ä»¶å†…å®¹ï¼\né”™è¯¯ä¿¡æ¯ï¼š' + error.message);
                    resetImportState();
                }
            };
            
            reader.onerror = function() {
                alert('æ–‡ä»¶è¯»å–å¤±è´¥ï¼Œè¯·é‡è¯•ï¼');
                resetImportState();
            };
            
            reader.readAsText(file);
        }

        // é‡ç½®å¯¼å…¥çŠ¶æ€
        function resetImportState() {
            importedJsonData = null;
            importedFileName = '';
            
            const fileInfo = document.getElementById('file-info');
            const importPreview = document.getElementById('import-preview');
            const importBtn = document.querySelector('.btn-import-process');
            const fileInput = document.getElementById('json-file-input');
            
            fileInfo.textContent = 'æœªé€‰æ‹©æ–‡ä»¶';
            fileInfo.classList.remove('selected');
            importPreview.style.display = 'none';
            importBtn.disabled = true;
            fileInput.value = '';
        }

        // å¤„ç†å¯¼å…¥çš„æ–‡ä»¶
        function processImportedFile() {
            if (!importedJsonData) {
                alert('è¯·å…ˆé€‰æ‹©è¦å¯¼å…¥çš„JSONæ–‡ä»¶ï¼');
                return;
            }

            // æ£€æµ‹ç¿»è¯‘ç±»å‹
            const detectedType = detectTranslationType(importedJsonData);
            if (!detectedType) {
                alert('æ— æ³•è¯†åˆ«ç¿»è¯‘æ–‡ä»¶çš„ç±»å‹ï¼Œè¯·ç¡®ä¿æ–‡ä»¶æ ¼å¼æ­£ç¡®ï¼');
                return;
            }

            // è‡ªåŠ¨é€‰æ‹©ç›¸åº”çš„ç¿»è¯‘ç±»å‹
            selectTranslationType(detectedType);

            // å¡«å……æ•°æ®
            populateDataFromImport(detectedType, importedJsonData);

            // æ˜¾ç¤ºæˆåŠŸæç¤º
            alert(`âœ… æˆåŠŸå¯¼å…¥${getTypeDisplayName(detectedType)}ç¿»è¯‘æ–‡ä»¶ï¼\næ–‡ä»¶åï¼š${importedFileName}.json\næ‚¨ç°åœ¨å¯ä»¥åœ¨æ­¤åŸºç¡€ä¸Šè¿›è¡Œç¼–è¾‘å’Œè¡¥å……ã€‚`);

            // æ»šåŠ¨åˆ°ç›¸åº”çš„é…ç½®åŒºåŸŸ
            const configSection = document.getElementById(detectedType + '-config');
            if (configSection) {
                configSection.scrollIntoView({ behavior: 'smooth' });
            }
        }

        // æ£€æµ‹ç¿»è¯‘ç±»å‹
        function detectTranslationType(data) {
            // æ£€æŸ¥æ˜¯å¦ä¸ºèŠ‚ç‚¹ç¿»è¯‘
            for (const key in data) {
                const item = data[key];
                if (typeof item === 'object' && (item.title || item.inputs || item.widgets || item.outputs)) {
                    return 'nodes';
                }
            }
            
            // æ£€æŸ¥æ˜¯å¦ä¸ºç®€å•çš„é”®å€¼å¯¹ï¼ˆåˆ†ç±»æˆ–èœå•ï¼‰
            let hasSimpleValues = true;
            for (const key in data) {
                if (typeof data[key] !== 'string') {
                    hasSimpleValues = false;
                    break;
                }
            }
            
            if (hasSimpleValues) {
                // æ ¹æ®æ–‡ä»¶åæˆ–å†…å®¹æ¨æ–­ç±»å‹
                if (importedFileName.toLowerCase().includes('categor') || 
                    importedFileName.toLowerCase().includes('åˆ†ç±»')) {
                    return 'categories';
                } else {
                    return 'menus'; // é»˜è®¤ä¸ºèœå•ç±»å‹
                }
            }
            
            return null;
        }

        // é€‰æ‹©ç¿»è¯‘ç±»å‹
        function selectTranslationType(type) {
            // ç§»é™¤æ‰€æœ‰æ´»åŠ¨çŠ¶æ€
            document.querySelectorAll('.type-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.config-section').forEach(section => section.classList.remove('active'));
            
            // è®¾ç½®å½“å‰ç±»å‹
            currentType = type;
            const typeBtn = document.querySelector(`[data-type="${type}"]`);
            if (typeBtn) {
                typeBtn.classList.add('active');
            }
            
            const configSection = document.getElementById(type + '-config');
            if (configSection) {
                configSection.classList.add('active');
            }
        }

        // å¡«å……å¯¼å…¥çš„æ•°æ®
        function populateDataFromImport(type, data) {
            if (type === 'categories') {
                populateCategoriesData(data);
            } else if (type === 'menus') {
                populateMenusData(data);
            } else if (type === 'nodes') {
                populateNodesData(data);
            }
        }

        // å¡«å……åˆ†ç±»æ•°æ®
        function populateCategoriesData(data) {
            const container = document.getElementById('categories-pairs');
            container.innerHTML = '';
            
            Object.keys(data).forEach(key => {
                const pair = createKeyValuePair('categories-pairs', 'removeCategoryPair');
                const inputs = pair.querySelectorAll('input');
                inputs[0].value = key;
                inputs[1].value = data[key];
                container.appendChild(pair);
            });

            if (container.children.length === 0) {
                container.innerHTML = '<div class="empty-state">ç‚¹å‡»ä¸‹æ–¹ + æŒ‰é’®æ·»åŠ åˆ†ç±»ç¿»è¯‘é¡¹</div>';
            }
        }

        // å¡«å……èœå•æ•°æ®
        function populateMenusData(data) {
            const container = document.getElementById('menus-pairs');
            container.innerHTML = '';
            
            Object.keys(data).forEach(key => {
                const pair = createKeyValuePair('menus-pairs', 'removeMenuPair');
                const inputs = pair.querySelectorAll('input');
                inputs[0].value = key;
                inputs[1].value = data[key];
                container.appendChild(pair);
            });

            if (container.children.length === 0) {
                container.innerHTML = '<div class="empty-state">ç‚¹å‡»ä¸‹æ–¹ + æŒ‰é’®æ·»åŠ èœå•ç¿»è¯‘é¡¹</div>';
            }
        }

        // å¡«å……èŠ‚ç‚¹æ•°æ®
        function populateNodesData(data) {
            // æ¸…ç†ç°æœ‰èŠ‚ç‚¹
            clearExistingNodes();
            
            const nodeNames = Object.keys(data);
            let nodeIndex = 0;
            
            nodeNames.forEach((nodeName, index) => {
                const nodeData = data[nodeName];
                
                // å¦‚æœä¸æ˜¯ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼Œåˆ›å»ºæ–°èŠ‚ç‚¹
                if (index > 0) {
                    addNewNodeForImport(nodeIndex + 1);
                    nodeIndex++;
                }
                
                // å¡«å……èŠ‚ç‚¹åŸºæœ¬ä¿¡æ¯
                const nodeNameInput = document.getElementById(`node-name-${nodeIndex}`);
                const nodeTitleInput = document.getElementById(`node-title-${nodeIndex}`);
                const nodeDescInput = document.getElementById(`node-desc-${nodeIndex}`);
                
                if (nodeNameInput) nodeNameInput.value = nodeName;
                if (nodeTitleInput && nodeData.title) nodeTitleInput.value = nodeData.title;
                if (nodeDescInput && nodeData.description) nodeDescInput.value = nodeData.description;
                
                // æ›´æ–°èŠ‚ç‚¹æ ‡ç­¾
                updateNodeTab(nodeIndex);
                
                // å¡«å……è¾“å…¥ã€æ§ä»¶ã€è¾“å‡ºæ•°æ®
                if (nodeData.inputs) {
                    populateKeyValueSection(`inputs-pairs-${nodeIndex}`, nodeData.inputs, 'removeInputPair');
                }
                if (nodeData.widgets) {
                    populateKeyValueSection(`widgets-pairs-${nodeIndex}`, nodeData.widgets, 'removeWidgetPair');
                }
                if (nodeData.outputs) {
                    populateKeyValueSection(`outputs-pairs-${nodeIndex}`, nodeData.outputs, 'removeOutputPair');
                }
                
                nodeIndex++;
            });
            
            // æ›´æ–°å…¨å±€å˜é‡
            nodeCount = nodeIndex;
            
            // åˆ‡æ¢åˆ°ç¬¬ä¸€ä¸ªèŠ‚ç‚¹
            switchToNode(0);
        }

        // ä¸ºå¯¼å…¥åˆ›å»ºæ–°èŠ‚ç‚¹ï¼ˆä¸è§¦å‘é»˜è®¤äº‹ä»¶ï¼‰
        function addNewNodeForImport(nodeIndex) {
            // æ·»åŠ èŠ‚ç‚¹æ ‡ç­¾
            const tabsContainer = document.querySelector('.node-tabs');
            const addButton = tabsContainer.querySelector('.btn-add-node');
            
            const newTab = document.createElement('button');
            newTab.className = 'node-tab';
            newTab.setAttribute('data-node', nodeIndex);
            newTab.onclick = () => switchToNode(nodeIndex);
            newTab.innerHTML = `
                <span>èŠ‚ç‚¹ ${nodeIndex + 1}</span>
                <button class="tab-close" onclick="removeNode(${nodeIndex}, event)">Ã—</button>
            `;
            
            tabsContainer.insertBefore(newTab, addButton);

            // åˆ›å»ºæ–°çš„èŠ‚ç‚¹é…ç½®
            const nodesContainer = document.getElementById('nodes-container');
            const newNodeConfig = document.createElement('div');
            newNodeConfig.className = 'single-node-config';
            newNodeConfig.id = `node-config-${nodeIndex}`;
            newNodeConfig.innerHTML = `
                <div class="node-basic-info">
                    <div class="node-name-input">
                        <label for="node-name-${nodeIndex}">ğŸ¯ èŠ‚ç‚¹ç±»å (Class Name):</label>
                        <input type="text" id="node-name-${nodeIndex}" placeholder="ä¾‹å¦‚: KSampler" onchange="updateNodeTab(${nodeIndex})">
                    </div>
                    
                    <div class="node-title-input">
                        <label for="node-title-${nodeIndex}">ğŸ·ï¸ ç¿»è¯‘åæ ‡é¢˜ (å¿…å¡«):</label>
                        <input type="text" id="node-title-${nodeIndex}" placeholder="ä¾‹å¦‚: Ké‡‡æ ·å™¨" required>
                    </div>
                    
                    <div class="node-description-input">
                        <label for="node-desc-${nodeIndex}">ğŸ“ èŠ‚ç‚¹åŠŸèƒ½æè¿° (å¯é€‰):</label>
                        <input type="text" id="node-desc-${nodeIndex}" placeholder="ä¾‹å¦‚: ä½¿ç”¨ä¸åŒçš„é‡‡æ ·å™¨å’Œè°ƒåº¦å™¨è¿›è¡Œå›¾åƒç”Ÿæˆ">
                    </div>
                </div>

                <div class="node-sections">
                    <!-- è¾“å…¥é¡¹ -->
                    <div class="key-value-section">
                        <div class="section-title">ğŸ“¥ è¾“å…¥ (Inputs)</div>
                        <div id="inputs-pairs-${nodeIndex}">
                            <div class="empty-state">ç‚¹å‡»ä¸‹æ–¹ + æŒ‰é’®æ·»åŠ è¾“å…¥é¡¹</div>
                        </div>
                        <div class="add-section">
                            <button class="btn btn-add" onclick="addInputPair(${nodeIndex})">+</button>
                        </div>
                    </div>

                    <!-- æ§ä»¶é¡¹ -->
                    <div class="key-value-section">
                        <div class="section-title">ğŸ›ï¸ æ§ä»¶ (Widgets)</div>
                        <div id="widgets-pairs-${nodeIndex}">
                            <div class="empty-state">ç‚¹å‡»ä¸‹æ–¹ + æŒ‰é’®æ·»åŠ æ§ä»¶é¡¹</div>
                        </div>
                        <div class="add-section">
                            <button class="btn btn-add" onclick="addWidgetPair(${nodeIndex})">+</button>
                        </div>
                    </div>

                    <!-- è¾“å‡ºé¡¹ -->
                    <div class="key-value-section">
                        <div class="section-title">ğŸ“¤ è¾“å‡º (Outputs)</div>
                        <div id="outputs-pairs-${nodeIndex}">
                            <div class="empty-state">ç‚¹å‡»ä¸‹æ–¹ + æŒ‰é’®æ·»åŠ è¾“å‡ºé¡¹</div>
                        </div>
                        <div class="add-section">
                            <button class="btn btn-add" onclick="addOutputPair(${nodeIndex})">+</button>
                        </div>
                    </div>
                </div>
            `;
            
            nodesContainer.appendChild(newNodeConfig);
        }

        // æ¸…ç†ç°æœ‰èŠ‚ç‚¹
        function clearExistingNodes() {
            // é‡ç½®èŠ‚ç‚¹è®¡æ•°å’Œå½“å‰ç´¢å¼•
            nodeCount = 1;
            currentNodeIndex = 0;
            
            // æ¸…ç†èŠ‚ç‚¹æ ‡ç­¾ï¼ˆä¿ç•™ç¬¬ä¸€ä¸ªï¼‰
            const tabsContainer = document.querySelector('.node-tabs');
            const allTabs = tabsContainer.querySelectorAll('.node-tab[data-node]');
            allTabs.forEach((tab, index) => {
                if (index > 0) { // ä¿ç•™ç¬¬ä¸€ä¸ªèŠ‚ç‚¹
                    tab.remove();
                }
            });
            
            // æ¸…ç†èŠ‚ç‚¹é…ç½®ï¼ˆä¿ç•™ç¬¬ä¸€ä¸ªï¼‰
            const nodesContainer = document.getElementById('nodes-container');
            const allConfigs = nodesContainer.querySelectorAll('.single-node-config');
            allConfigs.forEach((config, index) => {
                if (index > 0) { // ä¿ç•™ç¬¬ä¸€ä¸ªèŠ‚ç‚¹
                    config.remove();
                }
            });
            
            // æ¸…ç©ºç¬¬ä¸€ä¸ªèŠ‚ç‚¹çš„å†…å®¹
            const firstNodeIndex = 0;
            document.getElementById(`node-name-${firstNodeIndex}`).value = '';
            document.getElementById(`node-title-${firstNodeIndex}`).value = '';
            document.getElementById(`node-desc-${firstNodeIndex}`).value = '';
            
            // æ¸…ç©ºç¬¬ä¸€ä¸ªèŠ‚ç‚¹çš„é”®å€¼å¯¹
            clearKeyValueSection(`inputs-pairs-${firstNodeIndex}`, 'ç‚¹å‡»ä¸‹æ–¹ + æŒ‰é’®æ·»åŠ è¾“å…¥é¡¹');
            clearKeyValueSection(`widgets-pairs-${firstNodeIndex}`, 'ç‚¹å‡»ä¸‹æ–¹ + æŒ‰é’®æ·»åŠ æ§ä»¶é¡¹');
            clearKeyValueSection(`outputs-pairs-${firstNodeIndex}`, 'ç‚¹å‡»ä¸‹æ–¹ + æŒ‰é’®æ·»åŠ è¾“å‡ºé¡¹');
            
            // é‡ç½®ç¬¬ä¸€ä¸ªèŠ‚ç‚¹æ ‡ç­¾
            const firstTab = document.querySelector('[data-node="0"] span');
            if (firstTab) {
                firstTab.textContent = 'èŠ‚ç‚¹ 1';
            }
        }

        // å¡«å……é”®å€¼å¯¹åŒºåŸŸ
        function populateKeyValueSection(containerId, data, removeFunction) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            
            Object.keys(data).forEach(key => {
                const pair = createKeyValuePair(containerId, removeFunction);
                const inputs = pair.querySelectorAll('input');
                inputs[0].value = key;
                inputs[1].value = data[key];
                container.appendChild(pair);
            });
        }

        // æ¸…ç©ºé”®å€¼å¯¹åŒºåŸŸ
        function clearKeyValueSection(containerId, emptyText) {
            const container = document.getElementById(containerId);
            container.innerHTML = `<div class="empty-state">${emptyText}</div>`;
        }

        // è·å–ç±»å‹æ˜¾ç¤ºåç§°
        function getTypeDisplayName(type) {
            const names = {
                'categories': 'åˆ†ç±»',
                'nodes': 'èŠ‚ç‚¹',
                'menus': 'è®¾ç½®èœå•'
            };
            return names[type] || type;
        }
    </script>
</body>
</html>
